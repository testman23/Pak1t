<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Footsteps in the Wild - Interactive Tracking Adventure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #2d5016 0%, #4a7c59 50%, #5d8a3a 100%);
            color: #2d3e1f;
            min-height: 100vh;
            padding: 20px;
        }

        .game-container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #3a5f2a, #2d4a1f);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header::before {
            content: "üêæ";
            position: absolute;
            left: 20px;
            font-size: 2em;
        }

        .header::after {
            content: "üå≤";
            position: absolute;
            right: 20px;
            font-size: 2em;
        }

        .status-bar {
            background: #f0f8e7;
            padding: 15px;
            border-bottom: 2px solid #8fbc8f;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .status-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .status-label {
            font-weight: bold;
            color: #2d5016;
            display: block;
            font-size: 0.9em;
        }

        .status-value {
            font-size: 1.1em;
            color: #4a7c59;
            margin-top: 5px;
        }

        .scene-container {
            padding: 30px;
        }

        .scene-title {
            background: linear-gradient(45deg, #8fbc8f, #9acd32);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.3em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .track-display {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin: 20px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
            border: 2px solid #8fbc8f;
        }

        .track-info {
            background: white;
            padding: 20px;
            border-radius: 8px;
        }

        .track-image-container {
            background: #333;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            position: relative;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .track-image {
            max-width: 100%;
            max-height: 220px;
            border-radius: 8px;
            filter: sepia(20%) saturate(1.2);
        }

        .track-placeholder {
            color: #8fbc8f;
            font-size: 4em;
            opacity: 0.7;
        }

        .measurement-overlay {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(255,255,255,0.9);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8em;
            color: #333;
        }

        .environmental-conditions {
            background: linear-gradient(135deg, #e8f5e8, #d4e7d4);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #4a7c59;
        }

        .condition-icon {
            font-size: 1.2em;
            margin-right: 8px;
        }

        .clue-section {
            margin: 20px 0;
            padding: 15px;
            background: #fff8dc;
            border-radius: 8px;
            border: 1px solid #deb887;
        }

        .clue-header {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .clue-icon {
            font-size: 1.3em;
            margin-right: 10px;
        }

        .options-container {
            margin: 20px 0;
        }

        .option-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: linear-gradient(135deg, #8fbc8f, #9acd32);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .option-button:hover {
            background: linear-gradient(135deg, #7ba47b, #8bc34a);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .option-button:active {
            transform: translateY(0);
        }

        .feedback {
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            display: none;
        }

        .feedback.correct {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .feedback.incorrect {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .feedback.investigate {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .points-display {
            background: #4a7c59;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            display: inline-block;
            margin: 10px 0;
            font-weight: bold;
        }

        .species-notebook {
            background: #f0f8ff;
            border: 1px solid #b0c4de;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .notebook-entry {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 3px solid #4a7c59;
        }

        .difficulty-selector {
            margin: 20px 0;
        }

        .difficulty-option {
            display: inline-block;
            margin: 5px;
            padding: 10px 20px;
            background: #e9ecef;
            border: 2px solid #ced4da;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .difficulty-option:hover,
        .difficulty-option.selected {
            background: #4a7c59;
            color: white;
            border-color: #2d4a1f;
        }

        .weather-display {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .weather-icon {
            font-size: 1.5em;
        }

        .track-quality-indicator {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .quality-excellent { background: #28a745; color: white; }
        .quality-good { background: #ffc107; color: black; }
        .quality-poor { background: #dc3545; color: white; }

        .investigation-panel {
            background: #f8f9fa;
            border: 2px dashed #6c757d;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            display: none;
        }

        .investigation-panel.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .cast-opportunity {
            background: #e7f3ff;
            border: 2px solid #0066cc;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .cast-button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }

        .next-scene-button {
            background: linear-gradient(45deg, #4a7c59, #2d5016);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            margin: 20px auto;
            display: block;
        }

        .next-scene-button:hover {
            background: linear-gradient(45deg, #5d8a3a, #3a5f2a);
        }

        @media (max-width: 768px) {
            .track-display {
                grid-template-columns: 1fr;
            }
            
            .status-bar {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>üêæ FOOTSTEPS IN THE WILD üå≤</h1>
            <p>Interactive Animal Tracking Adventure</p>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <span class="status-label">Tracker</span>
                <div class="status-value" id="player-name">Anonymous Tracker</div>
            </div>
            <div class="status-item">
                <span class="status-label">Experience Points</span>
                <div class="status-value" id="experience-points">0</div>
            </div>
            <div class="status-item">
                <span class="status-label">Species Discovered</span>
                <div class="status-value" id="species-count">0</div>
            </div>
            <div class="status-item">
                <span class="status-label">Track Casts</span>
                <div class="status-value" id="cast-count">0</div>
            </div>
        </div>

        <div class="scene-container" id="game-content">
            <!-- Game content will be dynamically loaded here -->
        </div>
    </div>

    <script>
        class TrackingGame {
            constructor() {
                this.playerName = "";
                this.experiencePoints = 0;
                this.speciesDiscovered = [];
                this.trackCasts = [];
                this.environmentalNotes = [];
                this.difficulty = "experienced";
                this.currentScene = 0;
                this.weather = this.generateWeather();
                this.timeOfDay = this.generateTimeOfDay();
                
                this.gameContent = document.getElementById('game-content');
                this.updateStatusBar();
            }

            generateWeather() {
                const conditions = [
                    { condition: "clear", description: "Clear skies with excellent visibility", icon: "‚òÄÔ∏è", trackQuality: 1.0 },
                    { condition: "light_rain", description: "Light drizzle creating perfect mud", icon: "üå¶Ô∏è", trackQuality: 1.2 },
                    { condition: "heavy_rain", description: "Heavy rain washing away older tracks", icon: "üåßÔ∏è", trackQuality: 0.6 },
                    { condition: "snow", description: "Fresh snow preserving every detail", icon: "‚ùÑÔ∏è", trackQuality: 1.3 },
                    { condition: "wind", description: "Strong winds disturbing loose soil", icon: "üí®", trackQuality: 0.8 },
                    { condition: "fog", description: "Dense fog reducing visibility", icon: "üå´Ô∏è", trackQuality: 0.9 }
                ];
                return conditions[Math.floor(Math.random() * conditions.length)];
            }

            generateTimeOfDay() {
                const times = [
                    { period: "dawn", description: "Early morning with fresh dew", icon: "üåÖ", activity: "high" },
                    { period: "morning", description: "Mid-morning with warming sun", icon: "üå§Ô∏è", activity: "medium" },
                    { period: "midday", description: "Hot midday sun", icon: "‚òÄÔ∏è", activity: "low" },
                    { period: "afternoon", description: "Cooler afternoon light", icon: "üå§Ô∏è", activity: "medium" },
                    { period: "dusk", description: "Golden evening twilight", icon: "üåá", activity: "high" },
                    { period: "night", description: "Dark night requiring careful observation", icon: "üåô", activity: "medium" }
                ];
                return times[Math.floor(Math.random() * times.length)];
            }

            calculateTrackQuality(baseQuality) {
                let quality = baseQuality * this.weather.trackQuality;
                if (this.timeOfDay.activity === "high") quality *= 1.1;
                else if (this.timeOfDay.activity === "low") quality *= 0.9;
                return Math.min(quality, 1.5);
            }

            updateStatusBar() {
                document.getElementById('player-name').textContent = this.playerName || "Anonymous Tracker";
                document.getElementById('experience-points').textContent = this.experiencePoints;
                document.getElementById('species-count').textContent = this.speciesDiscovered.length;
                document.getElementById('cast-count').textContent = this.trackCasts.length;
            }

            awardPoints(points, reason) {
                this.experiencePoints += points;
                this.updateStatusBar();
                this.showPointsAwarded(points, reason);
            }

            showPointsAwarded(points, reason) {
                const pointsDisplay = document.createElement('div');
                pointsDisplay.className = 'points-display';
                pointsDisplay.innerHTML = `+${points} points - ${reason}`;
                this.gameContent.appendChild(pointsDisplay);
                
                setTimeout(() => {
                    pointsDisplay.style.opacity = '0';
                    setTimeout(() => pointsDisplay.remove(), 300);
                }, 2000);
            }

            addSpecies(species) {
                this.speciesDiscovered.push(species);
                this.updateStatusBar();
            }

            addTrackCast(cast) {
                this.trackCasts.push(cast);
                this.updateStatusBar();
            }

            getTrackQualityClass(quality) {
                if (quality > 1.1) return 'quality-excellent';
                if (quality > 0.8) return 'quality-good';
                return 'quality-poor';
            }

            getTrackQualityText(quality) {
                if (quality > 1.1) return 'Excellent';
                if (quality > 0.8) return 'Good';
                return 'Poor';
            }

            createTrackImage(animal, quality) {
                // For this demo, we'll use placeholder track images
                // In a full implementation, you'd have actual track photos
                const placeholder = `
                    <div class="track-placeholder">üêæ</div>
                    <div class="measurement-overlay">
                        Track Quality: <span class="track-quality-indicator ${this.getTrackQualityClass(quality)}">
                            ${this.getTrackQualityText(quality)}
                        </span>
                    </div>
                `;
                return placeholder;
            }

            startGame() {
                this.showIntroduction();
            }

            showIntroduction() {
                this.gameContent.innerHTML = `
                    <div class="scene-title">üéØ Welcome to Your Tracking Adventure</div>
                    
                    <div class="environmental-conditions">
                        <div class="weather-display">
                            <span class="weather-icon">${this.weather.icon}</span>
                            <div>
                                <strong>Weather:</strong> ${this.weather.description}<br>
                                <strong>Time:</strong> ${this.timeOfDay.icon} ${this.timeOfDay.description}
                            </div>
                        </div>
                    </div>

                    <div class="track-info">
                        <p style="font-size: 1.1em; margin-bottom: 20px;">
                            Welcome to the most advanced animal tracking simulator available! 
                            You'll learn to identify wildlife through tracks, scat, feeding sign, and behavioral clues.
                        </p>
                        
                        <div style="margin: 20px 0;">
                            <label for="player-name-input" style="display: block; margin-bottom: 10px; font-weight: bold;">
                                Enter your tracker name:
                            </label>
                            <input type="text" id="player-name-input" placeholder="Your name" 
                                   style="padding: 10px; border: 2px solid #8fbc8f; border-radius: 5px; width: 300px; max-width: 100%;">
                        </div>

                        <div class="difficulty-selector">
                            <p style="font-weight: bold; margin-bottom: 10px;">Choose your experience level:</p>
                            <div class="difficulty-option" data-difficulty="novice">
                                üü¢ Novice - Detailed clues and hints
                            </div>
                            <div class="difficulty-option selected" data-difficulty="experienced">
                                üü° Experienced - Standard challenges
                            </div>
                            <div class="difficulty-option" data-difficulty="expert">
                                üî¥ Expert - Minimal clues, realistic conditions
                            </div>
                        </div>

                        <button class="next-scene-button" onclick="game.beginAdventure()">
                            üå≤ Begin Your Tracking Adventure
                        </button>
                    </div>
                `;

                // Add event listeners for difficulty selection
                document.querySelectorAll('.difficulty-option').forEach(option => {
                    option.addEventListener('click', () => {
                        document.querySelectorAll('.difficulty-option').forEach(opt => 
                            opt.classList.remove('selected'));
                        option.classList.add('selected');
                        this.difficulty = option.dataset.difficulty;
                    });
                });
            }

            beginAdventure() {
                const nameInput = document.getElementById('player-name-input');
                this.playerName = nameInput.value.trim() || "Anonymous Tracker";
                this.updateStatusBar();
                this.showScene1();
            }

            showScene1() {
                const trackQuality = this.calculateTrackQuality(0.9);
                const ageHours = Math.floor(Math.random() * 6) + 2;

                this.gameContent.innerHTML = `
                    <div class="scene-title">üå≤ Scene 1: Forest Entrance</div>
                    
                    <div class="environmental-conditions">
                        <div class="weather-display">
                            <span class="weather-icon">${this.weather.icon}</span>
                            <div>
                                <strong>Current Conditions:</strong> ${this.weather.description}<br>
                                <strong>Time of Day:</strong> ${this.timeOfDay.icon} ${this.timeOfDay.description}<br>
                                <strong>Track Preservation:</strong> 
                                <span class="track-quality-indicator ${this.getTrackQualityClass(trackQuality)}">
                                    ${this.getTrackQualityText(trackQuality)}
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="track-display">
                        <div class="track-info">
                            <p style="margin-bottom: 15px;">
                                You stand at the forest's edge where recent rainfall has softened the ground. 
                                Looking down, you discover tracks approximately <strong>${ageHours} hours old</strong>...
                            </p>

                            <div class="clue-section">
                                <div class="clue-header">
                                    <span class="clue-icon">üîç</span>
                                    Track Details
                                </div>
                                ${trackQuality > 1.0 ? `
                                    <ul>
                                        <li>Five distinct toes on each print with prominent claw marks</li>
                                        <li>Rear prints: 3.5-4 inches long, front prints: 2.5-3 inches</li>
                                        <li>Alternating gait with occasional overlapping prints</li>
                                        <li>Clear palm pad with individual toe impressions</li>
                                        <li>Hand-like appearance of front tracks</li>
                                    </ul>
                                ` : trackQuality > 0.7 ? `
                                    <ul>
                                        <li>Five toes visible, some edge details worn</li>
                                        <li>Claw marks present but not deeply impressed</li>
                                        <li>Medium-sized mammal based on size</li>
                                        <li>Typical mammalian alternating gait pattern</li>
                                    </ul>
                                ` : `
                                    <ul>
                                        <li>Partial prints visible in firmer soil</li>
                                        <li>Some claw marks and toe impressions detectable</li>
                                        <li>Difficult to make out fine details due to conditions</li>
                                    </ul>
                                `}
                            </div>

                            ${this.difficulty !== "expert" ? `
                                <div class="clue-section">
                                    <div class="clue-header">
                                        <span class="clue-icon">üåø</span>
                                        Additional Sign
                                    </div>
                                    <ul>
                                        <li>Fresh scat: dark, tubular, containing berry seeds and insect parts</li>
                                        <li>Scratch marks on nearby tree trunk at shoulder height</li>
                                        <li>Small food cache under fallen log with shells and bits</li>
                                    </ul>
                                </div>
                            ` : ''}
                        </div>

                        <div class="track-image-container">
                            ${this.createTrackImage('raccoon', trackQuality)}
                        </div>
                    </div>

                    <div class="options-container">
                        <p style="font-weight: bold; margin-bottom: 15px;">What animal left these tracks?</p>
                        <button class="option-button" onclick="game.handleScene1Choice(1)">
                            ü¶ä Fox
                        </button>
                        <button class="option-button" onclick="game.handleScene1Choice(2)">
                            ü¶ù Raccoon
                        </button>
                        <button class="option-button" onclick="game.handleScene1Choice(3)">
                            üêÄ Opossum
                        </button>
                        <button class="option-button" onclick="game.handleScene1Choice(4)">
                            üîç Investigate further
                        </button>
                        <button class="option-button" onclick="game.handleScene1Choice(5)">
                            ü¶® Skunk
                        </button>
                    </div>

                    <div class="feedback" id="scene1-feedback"></div>
                    <div class="investigation-panel" id="investigation-panel"></div>
                `;
            }

            handleScene1Choice(choice) {
                const feedback = document.getElementById('scene1-feedback');
                const investigationPanel = document.getElementById('investigation-panel');
                
                if (choice === 2) { // Correct - Raccoon
                    feedback.className = 'feedback correct';
                    feedback.style.display = 'block';
                    feedback.innerHTML = `
                        <h3>‚úÖ Excellent identification!</h3>
                        <p>These are indeed <strong>raccoon tracks (Procyon lotor)</strong>. The five-toed pattern with prominent claws and the "hand-like" appearance of the front tracks are distinctive characteristics of raccoons.</p>
                        <p><strong>Behavioral Note:</strong> Raccoons are primarily nocturnal and excellent climbers. Their dexterous front paws allow them to manipulate objects and open containers.</p>
                    `;
                    this.awardPoints(15, "Correct identification on first try!");
                    this.addSpecies("Raccoon (Procyon lotor)");
                    this.showCastOpportunity(1.2);
                    
                } else if (choice === 4) { // Investigate further
                    investigationPanel.className = 'investigation-panel active';
                    investigationPanel.innerHTML = `
                        <h3>üîç Detailed Investigation</h3>
                        <p>You examine the tracks more carefully using proper measurement techniques...</p>
                        <ul>
                            <li><strong>Measurement:</strong> Hind foot measures 3.8 inches long</li>
                            <li><strong>Gait Analysis:</strong> Shows typical raccoon "pace" walking pattern</li>
                            <li><strong>Toe Pattern:</strong> Five long, thin toes resembling human fingers</li>
                            <li><strong>Claw Detail:</strong> Non-retractable claws extend beyond toe pads</li>
                        </ul>
                        <p style="margin-top: 15px;">Based on your detailed analysis, what is your identification?</p>
                        <button class="option-button" onclick="game.handleDetailedAnalysis(2)" style="margin-top: 10px;">
                            ü¶ù Raccoon (based on investigation)
                        </button>
                    `;
                    
                } else { // Incorrect choices
                    feedback.className = 'feedback incorrect';
                    feedback.style.display = 'block';
                    feedback.innerHTML = `
                        <h3>üîÑ Not quite right, but good observation!</h3>
                        <p>Upon closer examination, the five-toed pattern with the distinctive "hand-like" front tracks identifies these as <strong>raccoon tracks</strong>.</p>
                        <p><strong>Learning Point:</strong> The key identifying features are the five long toes and the palm pad arrangement that resembles a small human hand.</p>
                    `;
                    this.awardPoints(5, "Learning from mistakes");
                    this.addSpecies("Raccoon (Procyon lotor)");
                }
                
                setTimeout(() => {
                    this.showNextSceneButton();
                }, 1000);
            }

            handleDetailedAnalysis(choice) {
                const feedback = document.getElementById('scene1-feedback');
                feedback.className = 'feedback correct';
                feedback.style.display = 'block';
                feedback.innerHTML = `
                    <h3>‚úÖ Outstanding investigative work!</h3>
                    <p>Your methodical approach and detailed analysis correctly identifies these as <strong>raccoon tracks</strong>. This thorough technique is exactly how professional trackers work in the field.</p>
                    <p><strong>Professional Tip:</strong> Always measure tracks, analyze gait patterns, and look for associated sign before making final identifications.</p>
                `;
                this.awardPoints(20, "Thorough investigation and correct ID!");
                this.addSpecies("Raccoon (Procyon lotor) - detailed analysis");
                this.showCastOpportunity(1.3);
            }

            showCastOpportunity(quality) {
                if (quality > 1.1) {
                    const castDiv = document.createElement('div');
                    castDiv.className = 'cast-opportunity';
                    castDiv.innerHTML = `
                        <h3>üéØ Track Casting Opportunity!</h3>
                        <p>The track conditions are excellent for making a plaster cast. This would create a permanent record for your collection.</p>
                        <button class="cast-button" onclick="game.makeCast('Raccoon hind foot cast - excellent detail')">
                            üèõÔ∏è Make Plaster Cast
                        </button>
                        <button class="cast-button" onclick="this.parentElement.remove()" style="background: #6c757d;">
                            ‚è≠Ô∏è Continue Without Casting
                        </button>
                    `;
                    this.gameContent.appendChild(castDiv);
                }
            }

            makeCast(castDescription) {
                this.awardPoints(10, "Successful track casting!");
                this.addTrackCast(castDescription);
                
                const castDiv = document.querySelector('.cast-opportunity');
                castDiv.innerHTML = `
                    <h3>‚úÖ Cast Created Successfully!</h3>
                    <p>You've created an excellent plaster cast that captures fine details of the track. This will be valuable for future reference and study.</p>
                `;
                
                setTimeout(() => castDiv.remove(), 2000);
            }

            showNextSceneButton() {
                if (!document.querySelector('.next-scene-button')) {
                    const nextButton = document.createElement('button');
                    nextButton.className = 'next-scene-button';
                    nextButton.innerHTML = 'üå≤ Continue to Next Scene';
                    nextButton.onclick = () => this.showScene2();
                    this.gameContent.appendChild(nextButton);
                }
            }

            showScene2() {
                const trackQuality = this.calculateTrackQuality(1.1); // Mud preserves tracks well
                
                this.gameContent.innerHTML = `
                    <div class="scene-title">üèûÔ∏è Scene 2: Creek Crossing</div>
                    
                    <div class="environmental-conditions">
                        <div class="weather-display">
                            <span class="weather-icon">üíß</span>
                            <div>
                                <strong>Location:</strong> Meandering creek with muddy banks<br>
                                <strong>Substrate:</strong> Soft mud - excellent for track preservation<br>
                                <strong>Track Quality:</strong> 
                                <span class="track-quality-indicator ${this.getTrackQualityClass(trackQuality)}">
                                    ${this.getTrackQualityText(trackQuality)}
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="track-display">
                        <div class="track-info">
                            <p style="margin-bottom: 15px;">
                                You approach a shallow creek winding through mossy rocks. The soft substrate 
                                has captured exceptional track detail in the creek-side mud.
                            </p>

                            <div class="clue-section">
                                <div class="clue-header">
                                    <span class="clue-icon">üîç</span>
                                    Hoofed Mammal Tracks
                                </div>
                                ${trackQuality > 1.2 ? `
                                    <ul>
                                        <li>Perfect cloven hoof prints, classic heart-shaped</li>
                                        <li>2.5-3 inches long, pointed at front, rounded at rear</li>
                                        <li>Clear dew claw impressions in deeper prints</li>
                                        <li>Stride length: 24-30 inches, indicating walking gait</li>
                                        <li>Tracks lead to water's edge, then continue upstream</li>
                                    </ul>
                                ` : `
                                    <ul>
                                        <li>Cloven hoof impressions, somewhat weathered</li>
                                        <li>Approximately 2.5 inches long</li>
                                        <li>Pattern suggests careful placement near water</li>
                                    </ul>
                                `}
                            </div>

                            ${this.difficulty !== "expert" ? `
                                <div class="clue-section">
                                    <div class="clue-header">
                                        <span class="clue-icon">üåø</span>
                                        Feeding Sign & Scat
                                    </div>
                                    <ul>
                                        <li>Browse line visible on saplings at 4-5 foot height</li>
                                        <li>Fresh pellet-shaped scat scattered near tracks</li>
                                        <li>Nibbled fern fronds and wild grass</li>
                                        <li>Cautious approach pattern to water source</li>
                                    </ul>
                                </div>
                            ` : ''}

                            <div class="clue-section">
                                <div class="clue-header">
                                    <span class="clue-icon">üìù</span>
                                    Behavioral Observations
                                </div>
                                <ul>
                                    <li>Multiple track sets suggest small group (3-4 individuals)</li>
                                    <li>Cautious approach to water - safety-conscious behavior</li>
                                    <li>Tracks both coming and going - regular water source</li>
                                    <li>Alert posture indicated by track spacing</li>
                                </ul>
                            </div>
                        </div>

                        <div class="track-image-container">
                            ${this.createTrackImage('deer', trackQuality)}
                        </div>
                    </div>

                    <div class="options-container">
                        <p style="font-weight: bold; margin-bottom: 15px;">Which animal made these cloven hoof tracks?</p>
                        <button class="option-button" onclick="game.handleScene2Choice(1)">
                            ü¶å White-tailed Deer
                        </button>
                        <button class="option-button" onclick="game.handleScene2Choice(2)">
                            üêê Domestic Goat
                        </button>
                        <button class="option-button" onclick="game.handleScene2Choice(3)">
                            üîç Investigate substrate and gait patterns
                        </button>
                        <button class="option-button" onclick="game.handleScene2Choice(4)">
                            üêó Wild Boar
                        </button>
                        <button class="option-button" onclick="game.handleScene2Choice(5)">
                            ü´é Elk
                        </button>
                    </div>

                    <div class="feedback" id="scene2-feedback"></div>
                    <div class="investigation-panel" id="scene2-investigation"></div>
                `;
            }

            handleScene2Choice(choice) {
                const feedback = document.getElementById('scene2-feedback');
                const investigationPanel = document.getElementById('scene2-investigation');
                
                if (choice === 1) { // Correct - White-tailed Deer
                    feedback.className = 'feedback correct';
                    feedback.style.display = 'block';
                    feedback.innerHTML = `
                        <h3>‚úÖ Excellent identification!</h3>
                        <p>Correct! These are <strong>white-tailed deer (Odocoileus virginianus)</strong> tracks. The heart-shaped cloven hooves and cautious water approach are characteristic behaviors.</p>
                        <p><strong>Ecological Note:</strong> Deer are crepuscular (most active at dawn and dusk) and their cautious approach to water reflects constant vigilance for predators like coyotes and mountain lions.</p>
                        <p><strong>Track Tip:</strong> Dew claws only show in soft substrate or when the animal is running or walking in deep snow.</p>
                    `;
                    this.awardPoints(15, "Correct ungulate identification!");
                    this.addSpecies("White-tailed Deer (Odocoileus virginianus)");
                    
                } else if (choice === 3) { // Investigate further
                    investigationPanel.className = 'investigation-panel active';
                    investigationPanel.innerHTML = `
                        <h3>üîç Advanced Gait & Substrate Analysis</h3>
                        <p>You conduct a thorough scientific analysis of the tracks...</p>
                        
                        <div style="background: white; padding: 15px; border-radius: 5px; margin: 10px 0;">
                            <h4>Substrate Analysis:</h4>
                            <ul>
                                <li><strong>Depth:</strong> 2-3 inches into soft mud</li>
                                <li><strong>Edge Crispness:</strong> Sharp, indicating recent passage (< 6 hours)</li>
                                <li><strong>Substrate Consistency:</strong> Even compression throughout</li>
                            </ul>
                        </div>
                        
                        <div style="background: white; padding: 15px; border-radius: 5px; margin: 10px 0;">
                            <h4>Gait Pattern Analysis:</h4>
                            <ul>
                                <li><strong>Pattern:</strong> Direct-register walk (rear foot in front track)</li>
                                <li><strong>Pressure Release:</strong> Deeper at toe, indicating forward movement</li>
                                <li><strong>Stride Regularity:</strong> Consistent, showing calm, unhurried movement</li>
                                <li><strong>Straddle:</strong> Narrow, typical of sure-footed ungulate</li>
                            </ul>
                        </div>
                        
                        <p>Based on your detailed scientific analysis:</p>
                        <button class="option-button" onclick="game.handleScene2Analysis(1)" style="margin-top: 10px;">
                            ü¶å White-tailed Deer (confirmed by analysis)
                        </button>
                    `;
                    
                } else { // Incorrect choices
                    feedback.className = 'feedback incorrect';
                    feedback.style.display = 'block';
                    feedback.innerHTML = `
                        <h3>üîÑ Good observation, but not quite right</h3>
                        <p>These are actually <strong>white-tailed deer tracks</strong>. The cloven hoof shape, size, and cautious water approach behavior are diagnostic for this species.</p>
                        <p><strong>Learning Point:</strong> Size matters in track identification - these hooves are too small for elk, too large and pointed for goats, and lack the wider, rounder shape of wild boar.</p>
                    `;
                    this.awardPoints(8, "Learning opportunity");
                    this.addSpecies("White-tailed Deer (Odocoileus virginianus)");
                }
                
                setTimeout(() => {
                    this.showNextSceneButton2();
                }, 1000);
            }

            handleScene2Analysis(choice) {
                const feedback = document.getElementById('scene2-feedback');
                feedback.className = 'feedback correct';
                feedback.style.display = 'block';
                feedback.innerHTML = `
                    <h3>‚úÖ Outstanding scientific analysis!</h3>
                    <p>Your detailed gait and substrate analysis demonstrates professional-level tracking skills! The methodical approach confirms these are <strong>white-tailed deer tracks</strong>.</p>
                    <p><strong>Professional Recognition:</strong> Your analysis technique rivals that of wildlife biologists and professional trackers. You correctly identified track age, gait pattern, and behavioral indicators.</p>
                `;
                this.awardPoints(25, "Masterful tracking analysis!");
                this.addSpecies("White-tailed Deer - expert gait analysis");
            }

            showNextSceneButton2() {
                if (!document.querySelector('.next-scene-button')) {
                    const nextButton = document.createElement('button');
                    nextButton.className = 'next-scene-button';
                    nextButton.innerHTML = 'üå≤ Continue to Dense Thicket';
                    nextButton.onclick = () => this.showScene3();
                    this.gameContent.appendChild(nextButton);
                }
            }

            showScene3() {
                const trackQuality = this.calculateTrackQuality(0.7); // Leaf litter makes tracking harder
                
                this.gameContent.innerHTML = `
                    <div class="scene-title">üå≥ Scene 3: Dense Thicket</div>
                    
                    <div class="environmental-conditions">
                        <div class="weather-display">
                            <span class="weather-icon">üçÇ</span>
                            <div>
                                <strong>Terrain:</strong> Dense undergrowth with thick leaf litter<br>
                                <strong>Challenge Level:</strong> Difficult tracking conditions<br>
                                <strong>Track Visibility:</strong> 
                                <span class="track-quality-indicator ${this.getTrackQualityClass(trackQuality)}">
                                    ${this.getTrackQualityText(trackQuality)}
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="track-display">
                        <div class="track-info">
                            <p style="margin-bottom: 15px;">
                                Dense undergrowth and fallen leaves create challenging tracking conditions. 
                                You must look carefully for sign in this difficult environment.
                            </p>

                            <div class="clue-section">
                                <div class="clue-header">
                                    <span class="clue-icon">üîç</span>
                                    Predator Track Evidence
                                </div>
                                ${trackQuality > 0.8 ? `
                                    <ul>
                                        <li>Four-toed prints with triangular heel pad</li>
                                        <li>2.5-3 inches diameter, nearly round overall shape</li>
                                        <li>Claws barely visible - likely retractable</li>
                                        <li>Precise, straight-line walking pattern</li>
                                        <li>Stride length: 12-16 inches, indicating confident movement</li>
                                    </ul>
                                ` : `
                                    <ul>
                                        <li>Disturbed leaf litter in regular pattern</li>
                                        <li>Occasional clear print in bare soil patches</li>
                                        <li>Medium-sized mammal, digitigrade gait</li>
                                        <li>Purposeful, direct travel route</li>
                                    </ul>
                                `}
                            </div>

                            <div class="clue-section">
                                <div class="clue-header">
                                    <span class="clue-icon">üí©</span>
                                    Scat & Scent Evidence
                                </div>
                                <ul>
                                    <li>Small, segmented scat containing fur and bone fragments</li>
                                    <li>Strong musky scent permeating the area</li>
                                    <li>Scratched earth near base of large tree (scent marking)</li>
                                    <li>Prey remains indicate carnivorous diet</li>
                                </ul>
                            </div>

                            ${this.difficulty === "novice" ? `
                                <div class="clue-section">
                                    <div class="clue-header">
                                        <span class="clue-icon">üß¨</span>
                                        Additional Evidence
                                    </div>
                                    <ul>
                                        <li>Reddish hair with black tips caught on thorns</li>
                                        <li>Small prey remains cached under fallen log</li>
                                        <li>Territorial scent posts at regular intervals</li>
                                    </ul>
                                </div>
                            ` : ''}
                        </div>

                        <div class="track-image-container">
                            ${this.createTrackImage('fox', trackQuality)}
                        </div>
                    </div>

                    <div class="options-container">
                        <p style="font-weight: bold; margin-bottom: 15px;">Which predator made these tracks?</p>
                        <button class="option-button" onclick="game.handleScene3Choice(1)">
                            üê∫ Coyote
                        </button>
                        <button class="option-button" onclick="game.handleScene3Choice(2)">
                            ü¶ä Red Fox
                        </button>
                        <button class="option-button" onclick="game.handleScene3Choice(3)">
                            üîç Analyze scent marking behavior
                        </button>
                        <button class="option-button" onclick="game.handleScene3Choice(4)">
                            üê± Bobcat
                        </button>
                        <button class="option-button" onclick="game.handleScene3Choice(5)">
                            üê∫ Gray Wolf
                        </button>
                    </div>

                    <div class="feedback" id="scene3-feedback"></div>
                    <div class="investigation-panel" id="scene3-investigation"></div>
                `;
            }

            handleScene3Choice(choice) {
                const feedback = document.getElementById('scene3-feedback');
                const investigationPanel = document.getElementById('scene3-investigation');
                
                if (choice === 2) { // Correct - Red Fox
                    feedback.className = 'feedback correct';
                    feedback.style.display = 'block';
                    feedback.innerHTML = `
                        <h3>‚úÖ Excellent predator identification!</h3>
                        <p>Perfect! These are <strong>red fox (Vulpes vulpes)</strong> tracks. The neat, compact prints and straight-line gait are classic fox characteristics.</p>
                        <p><strong>Behavioral Note:</strong> Foxes are solitary hunters with territories ranging 1-3 square miles. Their straight-line travel pattern conserves energy while patrolling territory boundaries.</p>
                        <p><strong>Ecological Role:</strong> Red foxes help control rodent populations and are important predators in forest ecosystems.</p>
                    `;
                    this.awardPoints(18, "Correct predator identification!");
                    this.addSpecies("Red Fox (Vulpes vulpes)");
                    
                } else if (choice === 3) { // Investigate scent marking
                    investigationPanel.className = 'investigation-panel active';
                    investigationPanel.innerHTML = `
                        <h3>üîç Scent Marking Behavior Analysis</h3>
                        <p>You conduct a detailed study of the territorial marking patterns...</p>
                        
                        <div style="background: white; padding: 15px; border-radius: 5px; margin: 10px 0;">
                            <h4>Territorial Behavior:</h4>
                            <ul>
                                <li><strong>Scent Posts:</strong> Located at prominent features (stumps, rocks)</li>
                                <li><strong>Marking Frequency:</strong> Every 100-200 meters along trail</li>
                                <li><strong>Scratch Patterns:</strong> Hind foot scratching after scent marking</li>
                                <li><strong>Scent Intensity:</strong> Fresh, indicating recent passage (1-3 hours)</li>
                            </ul>
                        </div>
                        
                        <div style="background: white; padding: 15px; border-radius: 5px; margin: 10px 0;">
                            <h4>Behavioral Interpretation:</h4>
                            <ul>
                                <li><strong>Purpose:</strong> Territory establishment and maintenance</li>
                                <li><strong>Species Indicator:</strong> Musky scent typical of canid family</li>
                                <li><strong>Individual Markers:</strong> Suggests solitary territorial animal</li>
                                <li><strong>Confidence Level:</strong> Bold marking indicates established territory</li>
                            </ul>
                        </div>
                        
                        <p>Based on territorial behavior analysis:</p>
                        <button class="option-button" onclick="game.handleScene3Analysis(2)" style="margin-top: 10px;">
                            ü¶ä Red Fox (confirmed by scent marking pattern)
                        </button>
                    `;
                    
                } else { // Incorrect choices
                    feedback.className = 'feedback incorrect';
                    feedback.style.display = 'block';
                    feedback.innerHTML = `
                        <h3>üîÑ Good tracking effort!</h3>
                        <p>These tracks belong to a <strong>red fox</strong>. The compact, round shape and neat appearance distinguish fox tracks from their larger canine relatives.</p>
                        <p><strong>Distinguishing Features:</strong> Fox tracks are smaller and more precise than coyote tracks, and show the characteristic straight-line travel pattern of efficient predators.</p>
                    `;
                    this.awardPoints(10, "Good tracking effort");
                    this.addSpecies("Red Fox (Vulpes vulpes)");
                }
                
                setTimeout(() => {
                    this.showNotebookReview();
                }, 1000);
            }

            handleScene3Analysis(choice) {
                const feedback = document.getElementById('scene3-feedback');
                feedback.className = 'feedback correct';
                feedback.style.display = 'block';
                feedback.innerHTML = `
                    <h3>‚úÖ Masterful behavioral analysis!</h3>
                    <p>Outstanding! Your detailed study of scent marking behavior demonstrates advanced tracking skills. The territorial patterns confirm this is a <strong>red fox</strong>.</p>
                    <p><strong>Professional Insight:</strong> Understanding animal behavior through sign interpretation is the hallmark of expert trackers. You've successfully "read the story" the animal left behind.</p>
                `;
                this.awardPoints(22, "Excellent behavioral analysis!");
                this.addSpecies("Red Fox - territorial behavior study");
            }

            showNotebookReview() {
                setTimeout(() => {
                    this.gameContent.innerHTML = `
                        <div class="scene-title">üìù Field Notebook Review</div>
                        
                        <div class="species-notebook">
                            <h3>üèÜ Tracking Progress Report</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                                <div class="status-item">
                                    <span class="status-label">Experience Points</span>
                                    <div class="status-value">${this.experiencePoints}</div>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Species Documented</span>
                                    <div class="status-value">${this.speciesDiscovered.length}</div>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Track Casts Made</span>
                                    <div class="status-value">${this.trackCasts.length}</div>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Skill Level</span>
                                    <div class="status-value">${this.getSkillLevel()}</div>
                                </div>
                            </div>

                            <h4>üìã Species Documented:</h4>
                            ${this.speciesDiscovered.map((species, index) => 
                                `<div class="notebook-entry">${index + 1}. ${species}</div>`
                            ).join('')}

                            ${this.trackCasts.length > 0 ? `
                                <h4>üèõÔ∏è Track Casts Created:</h4>
                                ${this.trackCasts.map(cast => 
                                    `<div class="notebook-entry">‚Ä¢ ${cast}</div>`
                                ).join('')}
                            ` : ''}

                            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 20px 0;">
                                <h4>üåü Tracking Skills Assessment:</h4>
                                <p><strong>Current Level:</strong> ${this.getSkillLevel()}</p>
                                <p>${this.getSkillDescription()}</p>
                                ${this.experiencePoints >= 40 ? `
                                    <p style="color: #2d5016; font-weight: bold;">
                                        üéØ ADVANCED SCENARIOS UNLOCKED! Your skills qualify you for more challenging tracking situations.
                                    </p>
                                ` : ''}
                            </div>
                        </div>

                        <button class="next-scene-button" onclick="game.continueAdventure()">
                            üå≤ Continue Your Expedition
                        </button>
                    `;
                }, 2000);
            }

            getSkillLevel() {
                if (this.experiencePoints >= 100) return "Expert Tracker";
                if (this.experiencePoints >= 70) return "Advanced Tracker";
                if (this.experiencePoints >= 40) return "Competent Tracker";
                return "Developing Tracker";
            }

            getSkillDescription() {
                if (this.experiencePoints >= 100) {
                    return "Your tracking abilities rival those of professional wildlife biologists and indigenous trackers.";
                } else if (this.experiencePoints >= 70) {
                    return "You demonstrate strong tracking fundamentals and can handle complex scenarios.";
                } else if (this.experiencePoints >= 40) {
                    return "You're developing solid tracking skills with good attention to detail.";
                } else {
                    return "You're building foundational tracking knowledge. Keep practicing and observing!";
                }
            }

            continueAdventure() {
                this.showScene4();
            }

            showScene4() {
                this.gameContent.innerHTML = `
                    <div class="scene-title">üéØ Adventure Complete - Demo Version</div>
                    
                    <div class="track-info" style="text-align: center; padding: 40px;">
                        <h2>üèÜ Congratulations, ${this.playerName}!</h2>
                        
                        <div style="background: linear-gradient(135deg, #e8f5e8, #d4e7d4); padding: 30px; border-radius: 15px; margin: 20px 0;">
                            <h3>üìä Final Expedition Summary</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin: 20px 0;">
                                <div class="status-item">
                                    <span class="status-label">Final Score</span>
                                    <div class="status-value" style="font-size: 1.5em; color: #2d5016;">${this.experiencePoints}</div>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Species Found</span>
                                    <div class="status-value" style="font-size: 1.5em; color: #2d5016;">${this.speciesDiscovered.length}</div>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Final Rank</span>
                                    <div class="status-value" style="font-size: 1.2em; color: #2d5016;">${this.getSkillLevel()}</div>
                                </div>
                            </div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #8fbc8f; margin: 20px 0;">
                            <h4>üåü Full Version Features (Coming Soon):</h4>
                            <ul style="text-align: left; max-width: 500px; margin: 0 auto;">
                                <li>üñºÔ∏è Real track photographs and detailed illustrations</li>
                                <li>üîä Animal sounds and call identification</li>
                                <li>üåç 15+ different ecosystems and environments</li>
                                <li>üì± Mobile-responsive design for field use</li>
                                <li>üèÜ Advanced achievement and badge system</li>
                                <li>üìö Comprehensive field guide integration</li>
                                <li>üéØ Specialized tracking scenarios (tracking injured animals, aging tracks, etc.)</li>
                                <li>üë• Multiplayer challenges and competitions</li>
                            </ul>
                        </div>

                        <p style="font-size: 1.1em; margin: 20px 0;">
                            This demo showcased the enhanced tracking mechanics, but the full version will include 
                            actual track photographs, many more species, and realistic field scenarios.
                        </p>

                        <button class="next-scene-button" onclick="game.startGame()" style="margin: 20px;">
                            üîÑ Restart Adventure
                        </button>

                        <div style="background: #f0f8e7; padding: 20px; border-radius: 10px; margin: 20px 0;">
                            <h4>üìñ Recommended Real-World Resources:</h4>
                            <ul style="text-align: left; max-width: 600px; margin: 0 auto;">
                                <li><strong>Books:</strong> "Tom Brown's Field Guide to Nature Observation and Tracking"</li>
                                <li><strong>Apps:</strong> iNaturalist for species identification and tracking practice</li>
                                <li><strong>Organizations:</strong> Join local naturalist groups and tracking clubs</li>
                                <li><strong>Practice:</strong> Start with common animals in your local area</li>
                                <li><strong>Equipment:</strong> Get a measuring tape, field notebook, and plaster for casting</li>
                            </ul>
                        </div>
                    </div>
                `;
            }
        }

        // Initialize and start the game
        let game;
        
        window.addEventListener('load', () => {
            game = new TrackingGame();
            game.startGame();
        });
    </script>
</body>
</html>